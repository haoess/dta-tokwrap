<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>dtatw-cids2local.perl - convert //c/@xml:id attributes to page-local encoding</title>
<link rel="stylesheet" href="dtatw.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body>


<!-- INDEX BEGIN -->
<div name="index">
<p><a name="__index__"></a></p>

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#options_and_arguments">OPTIONS AND ARGUMENTS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#author">AUTHOR</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<hr />
<h1><a name="name">NAME</a></h1>
<p>dtatw-cids2local.perl - convert //c/@xml:id attributes to page-local encoding</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
 dtatw-cids2local.perl [OPTIONS] [XMLFILE(s)...]</pre>
<pre>
 Options:
  -help                  # this help message
  -output FILE           # specify output file (default='-' (STDOUT))
  -trace  TRACEFILE      # send trace output to file (default=none)</pre>
<p>
</p>
<hr />
<h1><a name="options_and_arguments">OPTIONS AND ARGUMENTS</a></h1>
<p>Not yet written.</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>Converts <code>//c/@xml:id</code> attributes to page-local encoding.</p>
<p>New IDs are computed page-locally, where the page element associated
with each <code>//c</code> is given by the XPath <code>preceding::pb[1]</code>, abbreviated
hereafter as $pb.  The associated $pb supplies a (unique) prefix <code>$pbid</code> to all
//c elements on the given page.  The prefix is determined according to the following
rules:</p>
<ol>
<li>
<p>If $pb has a @facs attribute, it is used to define $pbid by removing any prefix
matching the regex <code>/#?f?0*/</code> and prefixing a &quot;p&quot;, e.g. the following //pb elements
all map to $pbid=&quot;p42&quot;:</p>
<pre>
  &lt;pb facs=&quot;42&quot;/&gt;
  &lt;pb facs=&quot;#42&quot;/&gt;
  &lt;pb facs=&quot;#f0042&quot;/&gt;
  &lt;pb facs=&quot;f00042&quot;/&gt;
  &lt;pb facs=&quot;000042&quot;/&gt;</pre>
</li>
<li>
<p>Otherwise, a global counter over all //pb elements is used (whose value is initialized
to &quot;0&quot; (zero) before the initial //pb), prefixed by &quot;pz&quot;.</p>
<pre>
                  &lt;!-- before first page: $pbid=&quot;pz0&quot; --&gt;
  &lt;pb /&gt;          &lt;!-- first page, no @facs: $pbid=&quot;pz1&quot; --&gt;
  &lt;pb /&gt;          &lt;!-- second page, no @facs: $pbid=&quot;pz2&quot; --&gt;
  &lt;pb facs=&quot;42&quot;/&gt; &lt;!-- third page, with @facs: $pbid=&quot;p42&quot; --&gt;
  &lt;pb /&gt;          &lt;!-- fourth page: $pbid=&quot;pz4&quot; --&gt;</pre>
</li>
</ol>
<p>Finally, //c/@xml:id attributes are computed by a page-local counter <code>$ci</code>,
to be of the form <code>${pbid}.c${ci}</code>, e.g.:</p>
<pre>
  &lt;!-- before first page --&gt;
  &lt;c xml:id=&quot;pz0.c1&quot;/&gt;
  &lt;c xml:id=&quot;pz0.c2&quot;/&gt;
  &lt;!-- ... --&gt;</pre>
<pre>
  &lt;!-- first page, with @facs --&gt;
  &lt;pb facs=&quot;#f0042&quot;/&gt;
  &lt;c xml:id=&quot;p42.c1&quot;/&gt;
  &lt;c xml:id=&quot;p42.c2&quot;/&gt;
  &lt;!-- ... --&gt;</pre>
<pre>
  &lt;!-- second page, no @facs --&gt;
  &lt;pb/&gt;
  &lt;c xml:id=&quot;pz2.c1&quot;/&gt;
  &lt;c xml:id=&quot;pz2.c2&quot;/&gt;
  &lt;!-- ... --&gt;</pre>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><a href="././dta-tokwrap.perl.html">dta-tokwrap.perl(1)</a>,
<a href="././dtatw-add-c.perl.html">dtatw-add-c.perl(1)</a>,
<em>dtatw-rm-c.perl(1)</em>,
...</p>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Bryan Jurish &lt;<a href="mailto:jurish@bbaw.de">jurish@bbaw.de</a>&gt;</p>

</body>

</html>
